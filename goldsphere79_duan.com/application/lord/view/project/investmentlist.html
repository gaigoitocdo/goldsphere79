{include file="head" /}
{include file="menu" /}

<section id="main-content">
  <section class="wrapper">

    <!-- state overview start -->
    <div class="row state-overview">
      <form action="" method="get">
        <div class="container">
          <div class="row">

            <div class="col-lg-3 mar-10">
              <div class="input-group">
                <span class="input-group-addon" id="basic-addon1">Tài khoản</span>
                <input type="text" class="form-control" name="username"
                       placeholder="Biệt danh/Tên/Điện thoại/UID"
                       value="{$getdata.username?$getdata.username:''}">
              </div>
            </div>

            <div class="col-lg-6 mar-10">
              <div class="input-group">
                <span class="input-group-addon" id="basic-addon1">Thời gian tạo</span>
                <input type="text" id="datetimepicker" class="form-control" placeholder="Nhấp để chọn thời gian"
                       name="starttime" value="{$getdata.starttime?$getdata.starttime:''}">
                <span class="input-group-addon" id="basic-addon1">đến</span>
                <input type="text" id="datetimepicker_end" class="form-control" placeholder="Nhấp để chọn thời gian"
                       name="endtime" value="{$getdata.endtime?$getdata.endtime:''}">
              </div>
            </div>

            <div class="col-lg-3 mar-10">
              <div class="input-group">
                <span class="input-group-addon">Trạng thái</span>
                <select name="status" class="selectpicker show-tick form-control">
                  <option value="">Không chọn mặc định</option>
                  <option {if isset($getdata['status']) && $getdata['status'] == 1}selected{/if} value="1">Đang chạy</option>
                  <option {if isset($getdata['status']) && $getdata['status'] == 2}selected{/if} value="2">Hoàn tất</option>
                </select>
              </div>
            </div>

            <div class="col-lg-3 mar-10">
              <div class="input-group">
                <span class="input-group-addon">ID dự án</span>
                <input type="number" class="form-control" name="project_id"
                       value="{$getdata.project_id?$getdata.project_id:''}" placeholder="VD: 12">
              </div>
            </div>

          </div>
          <div class="mar-10">
            <input type="submit" class="btn btn-success" value="Tìm kiếm">
          </div>
        </div>
      </form>
    </div>
    <!-- state overview end -->

    <!--<a href="{:url('project/investmentlist')}">
      <button type="button" class="btn btn-danger">Tìm kiếm tất cả</button>
    </a>-->
    <br><br>

    <div class="row">
      <div class="col-lg-12">
        <section class="panel">
          <header class="panel-heading">Danh sách khoản đầu tư</header>
          <table class="table table-striped table-advance table-hover">
            <thead class="ordertable">
              <tr>
                <th>ID</th>
                <th>Thao tác</th>
                <th>UID</th>
                <th>Tài khoản</th>
                <th>Biệt danh</th>
                <th>Dự án</th>
                <th>Số tiền</th>
                <th>Lãi/ngày (%)</th>
                <th>Bắt đầu</th>
                <th>Đáo hạn</th>
                <th>Lần trả lãi tiếp</th>
                <th>Đã trả lãi</th>
                <th>Trạng thái</th>
              </tr>
            </thead>
            <tbody>
              <!-- {volist name="investment" id="vo"} -->
              <tr>
                <td>{$vo.id}</td>
                <td>
  <a class="btn btn-danger btn-xs" href="javascript:;" onclick="deleteInvestment({$vo.id})">Xóa</a>
</td>
                <td>{$vo.uid}</td>
                <td>{$vo.username}</td>
                <td>{$vo.nickname}</td>
                <td>{$vo.project_title} (#{$vo.project_id})</td>
                <td>{$vo.amount}</td>
                <td>{$vo.daily_rate_snapshot}</td>
                <td>{$vo.start_at}</td>
                <td>{$vo.end_at}</td>
                <td>{$vo.next_interest_at}</td>
                <td>{$vo.total_interest_paid}</td>
                <td>
                      {switch name="vo.status"}
                        {case value="1"}<span class="success">Đang chạy</span>{/case}
                        {case value="2"}<span class="muted">Hoàn tất</span>{/case}
                        {default /}<span class="muted">-</span>
                      {/switch}
                </td>
              </tr>
               <!-- {/volist} -->
            </tbody>
          </table>
        </section>
      </div>
    </div>

    {$investment->render()}

  </section>
</section>

{include file="foot" /}
{include file="foot" /}
<script>
$('#datetimepicker').datetimepicker();
$('#datetimepicker_end').datetimepicker();

function deleteInvestment(id){
  layer.open({
    content: 'Xóa khoản đầu tư #' + id + '?',
    yes: function(){
      $.post("{:url('project/investmentdel')}", {id:id}, function(res){
        layer.msg(res.data);
        if(res.type == 1){ history.go(0); }
      });
    }
  });
}
</script>